---
title: "thompson-kenneth-ADA-homework-2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## CHALLENGE 1

```{r movies}

library(tidyverse)
library(mosaic)

f <-"https://raw.githubusercontent.com/difiore/ADA-datasets/master/IMDB-movies.csv"
d <- read.csv(f)
e <- filter(d, startYear %in% 1920:1979 & runtimeMinutes <240) %>%
  mutate(decade = startYear - (startYear %% 10))

p <- ggplot(e, aes(runtimeMinutes)) + labs(x= "Movie Run Time") + geom_histogram() + facet_wrap( ~ decade)
p

results <- tibble(
  decade = unique(e$decade),
  mean = mean(runtimeMinutes ~ decade, data = e), 
  sd = sqrt(sum((runtimeMinutes - mean(runtimeMinutes~ decade, data = e))^2 ~ decade, data = e) / favstats(runtimeMinutes ~ decade, data = e)$n)
)
results

single_sample <- tibble(
  decade = c(1920,1930,1940,1950,1960,1970),
  mean = mean(runtimeMinutes ~ decade, data = sample_n(e, size = 100, replace = FALSE)),
  sd = sd(runtimeMinutes ~ decade, data = sample_n(e, size = 100, replace = FALSE))
) %>% 
  mutate(se = sd/sqrt(length(sd)))
single_sample
                        
comparison <- tibble(
  decade = single_sample$decade,
  mean.p = results$mean,
  se.p = results$sd/(sqrt(length(results$sd))),
  mean.ss = single_sample$mean,
  se.ss = single_sample$se
)
comparison

g <- lapply(1:10000, function(x) e[sample(nrow(e), size = 600, replace = F),])

```

## Challenge 2

```{r titi monkeys}
l <- 18
(fewer_than_13 <- ppois(13, lambda = l))
(no_calls <- dpois(0, lambda = l))
(exactly_7 <- dpois(7, lambda = l))  
(over_20 <- ppois(20, lambda = l, lower.tail = F))
(p1 <-
  plotDist(
    "pois",
    lambda = l,
    xlab = "x",
    ylab = "Pr(X=x",
    xlim = c(0, 40)
  ))
(sim <- rpois(520, lambda = l))
(p2 <- histogram(sim,
          xlim(0,40)))

```

## Challenge 3

``` {r zombies}
f <-"https://raw.githubusercontent.com/difiore/ADA-datasets/master/zombies.csv"
d <- read.csv(f)

names(d)

pop_sd <- function(x) {
  sqrt(sum((x - mean(x))^2) / (length(x)))
}

d_avg_tibble <- tibble(
  avg_height = mean(d$height),
  sd_height = pop_sd(d$height),
  avg_weight = mean(d$weight),
  sd_weight = pop_sd(d$weight),
  avg_killed = mean(d$zombies_killed),
  sd_killed = pop_sd(d$zombies_killed),
  avg_edu = mean(d$years_of_education),
)
d_avg_tibble

```
